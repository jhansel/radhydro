\documentclass[preprint,12pt]{elsarticle}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{color}
\input{newcommands}
\begin{document}

%===============================================================================
\section{Introduction}
%===============================================================================

In this work, a new IMEX scheme for solving the equations of radiation
hydrodynamics (RH) that is second-order accurate in both space and time is
presented and tested. A RH system combining a 1-D slab model
of compressible fluid dynamics with a grey radiation S$_2$ model is considered,
given by:
\begin{subequations}
\lequ{radhydro_system}
\be
\dxdy{\rho}{t}+\dxdy{}{x}\fn{\rho u} = 0 \pec
\lequ{cons_mass}
\ee 
\be
\dxdy{}{t}\fn{\rho u} + \dxdy{}{x}\fn{\rho u^2} + \dxdy{}{x}\fn{p}
  = \frac{\sigma_t}{c} \F_0 \pec
\lequ{cons_mom}
\ee
\be
\dxdy{E}{t} + \dxdy{}{x}\bracket{\fn{E+p}u}=-\sigma_a c \fn{aT^4 - \E}
  + \frac{\sigma_t u}{c} \F_0 \pec
\lequ{cons_energy}
\ee
\be
\frac{1}{c}\dxdy{\psi^+}{t} + \frac{1}{\sqrt{3}}\dxdy{\psi^+}{x}
  + \sigma_t \psi^+ = \frac{\sigma_s}{4\pi} c\E + \frac{\sigma_a}{4\pi} acT^4
  - \frac{\sigma_t u}{4\pi c} \F_0 + \frac{\sigma_t}{\sqrt{3}\pi}\E u
\pec
\lequ{intp}
\ee

\be
\frac{1}{c}\dxdy{\psi^-}{t} - \frac{1}{\sqrt{3}}\dxdy{\psi^-}{x}
  + \sigma_t \psi^- = \frac{\sigma_s}{4\pi} c\E + \frac{\sigma_a}{4\pi} acT^4
  - \frac{\sigma_t u}{4\pi c} \F_0 - \frac{\sigma_t}{\sqrt{3}\pi}\E u
\pec
\lequ{intm}
\ee
\end{subequations}
where $\rho$ is the density, $u$ is the velocity,
$E=\rho\fn{\frac{u^2}{2} + e}$ is the total material energy density,
$e$ is the specific internal energy density, $T$ is the material temperature,
$\E$ is the radiation energy density:
\be
\E = \frac{2\pi}{c}\fn{\psi^{+}+\psi^{-}} \pec
\lequ{Erad}
\ee
$\F$ is the radiation energy flux:
\be
\F = \frac{2\pi}{\sqrt{3}}\fn{\psi^{+}-\psi^{-}} \pec
\lequ{flux}
\ee
and $\F_0$ is an approximation to the comoving-frame flux,
\be
\lequ{F_nu_0}
\F_0 = \F-\frac{4}{3} \E u \pep
\ee
Note that multiplying Eqs.~\requ{intp} and \requ{intm} by $2\pi$ and summing
them gives the radiation energy equation:
\begin{subequations}
\be
\dxdy{\E}{t} + \dxdy{\F}{x} = \sigma_a c(aT^4 - \E) - \frac{\sigma_t u}{c}\F_0 \pec
\lequ{erad}
\ee
and multiplying \equ{intp} by $\frac{2\pi}{c\sqrt{3}}$ and \equ{intm} by
$-\frac{2\pi}{c\sqrt{3}}$ and sum them, we get the radiation momentum equation: 
\be
\frac{1}{c^2}\dxdy{\F}{t} + \frac{1}{3}\dxdy{\E}{x} = -\frac{\sigma_t}{c}\F_0 \pep
\ee
\end{subequations}

Equations \requ{cons_mass} through \requ{intm} are closed by assuming an ideal
equation of state (EOS):
\begin{subequations}
\be
p=\rho e (\gamma -1)
\lequ{pressure}
\pec
\ee
\be
T = \frac{e}{c_v} \pec
\lequ{matemp}
\ee
\end{subequations}
where $\gamma$ is the adiabatic index, and $c_v$ is the specific heat capacity.
However, the method presented is compatible with any valid EOS. 

%===============================================================================
\subsection{Source Definitions for the S$_2$ Equations}
%===============================================================================

Taking the zeroth angular moment of the S$_2$ equations, given by Equations
\requ{intp} and \requ{intm}, gives
\be
\frac{1}{c}\dxdt{\phi} + \dydx{\F} + \sigma_t\phi = \sigma_s\phi + Q_0 \pec
\lequ{zerothmoment}
\ee
where $\phi = c\E$ and the source $Q_0$ is
\be
Q_0 = \sigma_a acT^4 - \sigma_t\frac{u}{c}\F_0 \pep
\lequ{Q0}
\ee
Taking the first angular moment of the S$_2$ equations gives
\be
\frac{1}{c}\dxdt{\F} + \dydx{\phi} + \sigma_t\F = Q_1 \pec
\lequ{firstmoment}
\ee
where $Q_1$ is
\be
Q_1 = \frac{4}{3}\sigma_t\E u \pep
\lequ{Q1}
\ee
Rewriting the S$_2$ equations and employing the definitions given by Equations
\requ{Q0} and \requ{Q1} gives
\be
\frac{1}{c}\dxdt{\psi^\pm} + \mu^\pm\dydx{\psi^\pm} + \sigma_t\psi^\pm
  = \frac{\sigma_s}{4\pi}\phi + \frac{1}{4\pi}Q_0 + \frac{3\mu^\pm}{4\pi}Q_1 \pec
\lequ{S2Q}
\ee
where $\mu^\pm=\pm\frac{1}{\sqrt{3}}$.

%===============================================================================
\section{Solution Overview}
%===============================================================================
\subsection{Pseudocode}
%-------------------------------------------------------------------------------
\begin{enumerate}
  \item CN from $n$ to $n+\fourth$
  \item CN from $n+\fourth$ to $n+\half$
  \item CN from $n+\half$ to $n+\frac{3}{4}$
  \item BDF-2 from $n$ to $n+1$
\end{enumerate}

%===============================================================================
\section{Temporal Discretization}
%===============================================================================
\subsection{Euler Equations Momentum Source Update}
%-------------------------------------------------------------------------------
\subsubsection{Crank-Nicolson}
%-------------------------------------------------------------------------------
\begin{equation}
  \frac{\rho_i^{n+1}\left(u_i^{k+1}-u_i^*\right)}{\dt} = 
   \half\left[\frac{\sigma_{t,i}}{c}\left(\F_i-\frac{4}{3}\E_i u_i\right)\right]^n
  +\half\left[\frac{\sigma_{t,i}}{c}\left(\F_i-\frac{4}{3}\E_i u_i\right)\right]^k
\end{equation}
\subsubsection{BDF-2}
%-------------------------------------------------------------------------------
\begin{equation}
  \frac{\rho_i^{n+1}\left(u_i^{k+1}-u_i^*\right)}{\half\dt} = 
   \sixth\left[\frac{\sigma_{t,i}}{c}\left(\F_i-\frac{4}{3}\E_i u_i\right)\right]^n
  +\sixth\left[\frac{\sigma_{t,i}}{c}\left(\F_i-\frac{4}{3}\E_i u_i\right)\right]^{n+\half}
  +\frac{2}{3}\left[\frac{\sigma_{t,i}}{c}\left(\F_i-\frac{4}{3}\E_i u_i\right)\right]^{k+1}
\end{equation}

\subsection{Euler Equations Energy Source Update}
%-------------------------------------------------------------------------------
\subsubsection{Crank-Nicolson}
%-------------------------------------------------------------------------------
\begin{equation}\begin{split}
  \frac{E_i^{k+1}-E_i^*}{\dt} = &
  -\half\left[\sigma_{a,i} c\left(aT_i^4 - \E_i\right)\right]^{n}
  -\half\left[\sigma_{a,i}^k c\left(a(T_i^{k+1})^4 - \E_i^{k+1}\right)\right]\\
  &+\half\left[\sigma_{t,i}\frac{u_i}{c}\left(\F_i-\frac{4}{3}\E_i u\right)\right]^{#1}
   +\half\left[\sigma_t\frac{u}{c}\left(\F-\frac{4}{3}\E u\right)\right]^k
\end{split}\end{equation}
\subsubsection{BDF-2}
%-------------------------------------------------------------------------------
\begin{equation}\begin{split}
  \frac{E^{k+1}-E^{#1}}{#3\dt} = &
  -\td\left[\sigma_a c\left(aT^4 - \E\right)\right]^{#1}
  -\td\left[\sigma_a c\left(aT^4 - \E\right)\right]^{#2}
  -\td\left[\sigma_a^k c\left(a(T^{k+1})^4 - \E^{k+1}\right)\right]\\
  &+\td\left[\sigma_t\frac{u}{c}\left(\F-\frac{4}{3}\E u\right)\right]^{#1}
   +\td\left[\sigma_t\frac{u}{c}\left(\F-\frac{4}{3}\E u\right)\right]^{#2}
   +\td\left[\sigma_t\frac{u}{c}\left(\F-\frac{4}{3}\E u\right)\right]^k
\end{split}\end{equation}


\subsection{S$_2$ Equations}
%-------------------------------------------------------------------------------
\subsubsection{Crank-Nicolson}
%-------------------------------------------------------------------------------
Applying the Crank-Nicolson scheme to Equation \requ{S2Q}, the S-2 equations become
\be\begin{split}
\frac{1}{c}\frac{\psi^{\pm,k+1}-\psi^{\pm,n}}{\dt} = &
  -\half\mu^\pm\dydx{\psi^{\pm,n}} -\half\mu^\pm\dydx{\psi^{\pm,k+1}}\\
  &-\half\sigma_t^n\psi^{\pm,n} -\half\sigma_t^k\psi^{\pm,k+1}\\
  &+\half\frac{\sigma_s^n}{4\pi}\phi^n +\half\frac{\sigma_s^k}{4\pi}\phi^{k+1}\\
  &+\half\frac{1}{4\pi}Q_0^n +\half\frac{1}{4\pi}Q_0^{k+1}\\
  &+\half\frac{3\mu^\pm}{4\pi}Q_1^n +\half\frac{3\mu^\pm}{4\pi}Q_1^{k+1} \pec
\lequ{S2CN}
\end{split}\ee
where $k$ represents the $k$th iteration of a quantity at time $t^{n+1}$.

\subsubsection{BDF-2}
%-------------------------------------------------------------------------------
Applying the BDF-2 scheme to Equation \requ{S2Q}, the S-2 equations become
\be\begin{split}
\frac{1}{c}\frac{\psi^{\pm,k+1}-\psi^{\pm,n}}{\dt} = &
  -\third\mu^\pm\dydx{\psi^{\pm,n}}
  -\third\mu^\pm\dydx{\psi^{\pm,n+\half}}
  -\third\mu^\pm\dydx{\psi^{\pm,k+1}}\\
  &-\third\sigma_t^n\psi^{\pm,n}
   -\third\sigma_t^{n+\half}\psi^{\pm,n+\half}
   -\third\sigma_t^k\psi^{\pm,k+1}\\
  &+\third\frac{\sigma_s^n}{4\pi}\phi^n
   +\third\frac{\sigma_s^{n+\half}}{4\pi}\phi^{n+\half}
   +\third\frac{\sigma_s^k}{4\pi}\phi^{k+1}\\
  &+\third\frac{1}{4\pi}Q_0^n
   +\third\frac{1}{4\pi}Q_0^{n+\half}
   +\third\frac{1}{4\pi}Q_0^{k+1}\
  &+\third\frac{3\mu^\pm}{4\pi}Q_1^n
   +\third\frac{3\mu^\pm}{4\pi}Q_1^{n+\half}
   +\third\frac{3\mu^\pm}{4\pi}Q_1^{k+1} \pec
\lequ{S2BDF2}
\end{split}\ee
where $k$ represents the $k$th iteration of a quantity at time $t^{n+1}$.

%===============================================================================
\section{Spatial Discretization}
%===============================================================================

A lumped linear discontinuous spatial discretization is employed, so the
numerical unknowns are the left and right values $\psi_{i,L}^\pm$ and
$\psi_{i,R}^\pm$ for each cell $i$. The spatially
discretized equations result from integrating each half cell
$(x_i-\frac{h_i}{2},x_i)$ and $(x_i,x_i+\frac{h_i}{2})$,
where $x_i$ is the cell center, and $h_i$ is the cell width.
Integrating the first half cell gives
\begin{multline}
\frac{1}{c}\dxdt{\psi^\pm_{i,L}}\frac{h_i}{2}
  + \mu^\pm\fn{\psi_i^\pm-\psi_{i-\half}^\pm}
  + \sigma_{t,i,L}\psi_{i,L}^\pm\frac{h_i}{2} \\
  = \frac{\sigma_{s,i,L}}{4\pi}\phi_{i,L}\frac{h_i}{2}
  + \frac{1}{4\pi}Q_{0,i,L}\frac{h_i}{2}
  + \frac{3\mu^\pm}{4\pi}Q_{1,i,L}\frac{h_i}{2} \pec
\lequ{S2left}
\end{multline}
where $\psi_i^\pm=\half\fn{\psi_{i,L}^\pm + \psi_{i,R}^\pm}$,
$\psi_{i+\half}^+=\psi_{i,R}^+$, and $\psi_{i+\half}^-=\psi_{i+1,L}^-$.
Similarily, for the second half cell,
\begin{multline}
\frac{1}{c}\dxdt{\psi^\pm_{i,R}}\frac{h_i}{2}
  + \mu^\pm\fn{\psi_{i+\half}^\pm-\psi_i^\pm}
  + \sigma_{t,i,R}\psi_{i,R}^\pm\frac{h_i}{2} \\
  = \frac{\sigma_{s,i,R}}{4\pi}\phi_{i,R}\frac{h_i}{2}
  + \frac{1}{4\pi}Q_{0,i,R}\frac{h_i}{2}
  + \frac{3\mu^\pm}{4\pi}Q_{1,i,R}\frac{h_i}{2} \pep
\lequ{S2right}
\end{multline}

%===============================================================================
\section{Full Discretization}
%===============================================================================
\subsection{S$_2$ Equations}
%-------------------------------------------------------------------------------
\subsubsection{Crank-Nicolson}
%-------------------------------------------------------------------------------
The fully discretized S$_2$ equations for a Crank-Nicolson step are
\be\begin{split}
\frac{1}{c}\frac{\psi\iL^{\pm,k+1}-\psi\iL^{\pm,n}}{\dt} = &
  -\half\mu^\pm\fn{\psi^{\pm,n}_i - \psi^{\pm,n}_{i-\half}}
  -\half\mu^\pm\fn{\psi^{\pm,k+1}_i - \psi^{\pm,k+1}_{i-\half}}\\
  &-\half\sigma_{t,i,L}^n\frac{h_i}{2}\psi\iL^{\pm,n}
   -\half\sigma_{t,i,L}^k\frac{h_i}{2}\psi\iL^{\pm,k+1}\\
  &+\half\frac{\sigma_{s,i,L}^n}{4\pi}\frac{h_i}{2}\phi\iL^n
   +\half\frac{\sigma_{s,i,L}^k}{4\pi}\frac{h_i}{2}\phi\iL^{k+1}\\
  &+\half\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,L}^n
   +\half\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,L}^{k+1}\\
  &+\half\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,L}^n
   +\half\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,L}^{k+1} \pec
\lequ{S2CNfullL}
\end{split}\ee

\be\begin{split}
\frac{1}{c}\frac{\psi\iR^{\pm,k+1}-\psi\iR^{\pm,n}}{\dt} = &
  -\half\mu^\pm\fn{\psi^{\pm,n}_{i+\half} - \psi^{\pm,n}_i}
  -\half\mu^\pm\fn{\psi^{\pm,k+1}_{i+\half} - \psi^{\pm,k+1}_i}\\
  &-\half\sigma_{t,i,R}^n\frac{h_i}{2}\psi\iR^{\pm,n}
   -\half\sigma_{t,i,R}^k\frac{h_i}{2}\psi\iR^{\pm,k+1}\\
  &+\half\frac{\sigma_{s,i,R}^n}{4\pi}\frac{h_i}{2}\phi\iR^n
   +\half\frac{\sigma_{s,i,R}^k}{4\pi}\frac{h_i}{2}\phi\iR^{k+1}\\
  &+\half\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,R}^n
   +\half\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,R}^{k+1}\\
  &+\half\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,R}^n
   +\half\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,R}^{k+1} \pec
\lequ{S2CNfullR}
\end{split}\ee
where
\be
Q_{0,i,L}^{k+1}=\sigma_{a,i,L}^k a c \fn{T_{i,L}^k}^4
  -\sigma_{t,i,L}^k\frac{u_{i,L}^k}{c}\F_{0,i,L}^{k+1} \pec
\ee
\be
Q_{1,i,L}^{k+1}=\sigma_{t,i,L}^k \E_{i,L}^{k+1} u_{i,L}^k \pec
\ee
\be
\F_{0,i,L}^{k+1}=\F_{i,L}^{k+1} - \frac{4}{3}\E_{i,L}^{k+1}u_{i,L}^k \pec
\ee
\be
\F\iL^{k+1} = \frac{2\pi}{\sqrt{3}}\fn{\psi\iL^{+,k+1}-\psi\iL^{-,k+1}} \pec
\ee
\be
\E\iL^{k+1} = \frac{2\pi}{c}\fn{\psi\iL^{+,k+1}+\psi\iL^{-,k+1}} \pec
\ee
and quantities at the right state $i,R$ are similarly defined.

\subsubsection{BDF-2}
%-------------------------------------------------------------------------------
The fully discretized S$_2$ equations for a BDF-2 step are
\be\begin{split}
\frac{1}{c}\frac{\psi\iL^{\pm,k+1}-\psi\iL^{\pm,n}}{\dt} = &
   -\third\mu^\pm\fn{\psi^{\pm,n}_i - \psi^{\pm,n}_{i-\half}}
   -\third\mu^\pm\fn{\psi^{\pm,n+\half}_i - \psi^{\pm,n+\half}_{i-\half}}\\
  &-\third\mu^\pm\fn{\psi^{\pm,k+1}_i - \psi^{\pm,k+1}_{i-\half}}\\
  &-\third\sigma_{t,i,L}^n\frac{h_i}{2}\psi\iL^{\pm,n}
   -\third\sigma_{t,i,L}^{n+\half}\frac{h_i}{2}\psi\iL^{\pm,n+\half}
   -\third\sigma_{t,i,L}^k\frac{h_i}{2}\psi\iL^{\pm,k+1}\\
  &+\third\frac{\sigma_{s,i,L}^n}{4\pi}\frac{h_i}{2}\phi\iL^n
   +\third\frac{\sigma_{s,i,L}^{n+\half}}{4\pi}\frac{h_i}{2}\phi\iL^{n+\half}
   +\third\frac{\sigma_{s,i,L}^k}{4\pi}\frac{h_i}{2}\phi\iL^{k+1}\\
  &+\third\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,L}^n
   +\third\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,L}^{n+\half}
   +\third\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,L}^{k+1}\\
  &+\third\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,L}^n
   +\third\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,L}^{n+\half}
   +\third\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,L}^{k+1} \pec
\lequ{S2BDF2fullL}
\end{split}\ee

\be\begin{split}
\frac{1}{c}\frac{\psi\iR^{\pm,k+1}-\psi\iR^{\pm,n}}{\dt} = &
   -\third\mu^\pm\fn{\psi^{\pm,n}_{i+\half}       - \psi^{\pm,n}_i}
   -\third\mu^\pm\fn{\psi^{\pm,n+\half}_{i+\half} - \psi^{\pm,n+\half}_i}\\
  &-\third\mu^\pm\fn{\psi^{\pm,k+1}_{i+\half}     - \psi^{\pm,k+1}_i}\\
  &-\third\sigma_{t,i,R}^n\frac{h_i}{2}\psi\iR^{\pm,n}
   -\third\sigma_{t,i,R}^{n+\half}\frac{h_i}{2}\psi\iR^{\pm,n+\half}
   -\third\sigma_{t,i,R}^k\frac{h_i}{2}\psi\iR^{\pm,k+1}\\
  &+\third\frac{\sigma_{s,i,R}^n}{4\pi}\frac{h_i}{2}\phi\iR^n
   +\third\frac{\sigma_{s,i,R}^{n+\half}}{4\pi}\frac{h_i}{2}\phi\iR^{n+\half}
   +\third\frac{\sigma_{s,i,R}^k}{4\pi}\frac{h_i}{2}\phi\iR^{k+1}\\
  &+\third\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,R}^n
   +\third\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,R}^{n+\half}
   +\third\frac{1}{4\pi}\frac{h_i}{2}Q_{0,i,R}^{k+1}\\
  &+\third\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,R}^n
   +\third\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,R}^{n+\half}
   +\third\frac{3\mu^\pm}{4\pi}\frac{h_i}{2}Q_{1,i,R}^{k+1} \pep
\lequ{S2BDF2fullR}
\end{split}\ee

\end{document}
